(()=>{"use strict";const e=window.wp.blocks,t=window.React,i=window.wp.blockEditor,r=window.wp.components,a=window.wp.compose,s=window.wp.data,n=window.wp.element,c=window.wp.i18n,o=window.bp.blockData,l=(0,a.compose)([(0,s.withSelect)(((e,t)=>{const{url:i}=t.attributes,{getEmbedPreview:r,isRequestingEmbedPreview:a}=e("core");return{preview:!!i&&r(i),fetching:!!i&&a(i)}}))])((({attributes:e,setAttributes:a,isSelected:s,preview:l,fetching:d})=>{const p=(0,i.useBlockProps)(),{url:m,caption:u}=e,b=(0,c.__)("BuddyPress Activity URL","buddypress"),[y,w]=(0,n.useState)(m),[v,E]=(0,n.useState)(!m),h=(0,t.createElement)(i.BlockControls,null,(0,t.createElement)(r.ToolbarGroup,null,(0,t.createElement)(r.ToolbarButton,{icon:"edit",title:(0,c.__)("Edit URL","buddypress"),onClick:e=>{e&&e.preventDefault(),E(!0)}})));return v?(0,t.createElement)("div",{...p},(0,t.createElement)(r.Placeholder,{icon:"buddicons-activity",label:b,className:"wp-block-embed",instructions:(0,c.__)("Paste the link to the activity content you want to display on your site.","buddypress")},(0,t.createElement)("form",{onSubmit:e=>{e&&e.preventDefault(),E(!1),a({url:y})}},(0,t.createElement)("input",{type:"url",value:y||"",className:"components-placeholder__input","aria-label":b,placeholder:(0,c.__)("Enter URL to embed here…","buddypress"),onChange:e=>w(e.target.value)}),(0,t.createElement)(r.Button,{variant:"primary",type:"submit"},(0,c.__)("Embed","buddypress"))),(0,t.createElement)("div",{className:"components-placeholder__learn-more"},(0,t.createElement)(r.ExternalLink,{href:(0,c.__)("https://github.com/buddypress/buddypress/tree/master/docs/user/components/activity/embeds.md","buddypress")},(0,c.__)("Learn more about activity embeds","buddypress"))))):d?(0,t.createElement)("div",{className:"wp-block-embed is-loading"},(0,t.createElement)(r.Spinner,null),(0,t.createElement)("p",null,(0,c.__)("Embedding…","buddypress"))):l&&l.x_buddypress&&"activity"===l.x_buddypress?(0,t.createElement)("div",{...p},!v&&h,(0,t.createElement)("figure",{className:"wp-block-embed is-type-bp-activity"},(0,t.createElement)("div",{className:"wp-block-embed__wrapper"},(0,t.createElement)(r.Disabled,null,(0,t.createElement)(r.SandBox,{html:l&&l.html?l.html:"",scripts:[o.embedScriptURL]}))),(!i.RichText.isEmpty(u)||s)&&(0,t.createElement)(i.RichText,{tagName:"figcaption",placeholder:(0,c.__)("Write caption…","buddypress"),value:u,onChange:e=>a({caption:e}),inlineToolbar:!0}))):(0,t.createElement)("div",{...p},h,(0,t.createElement)(r.Placeholder,{icon:"buddicons-activity",label:b},(0,t.createElement)("p",{className:"components-placeholder__error"},(0,c.__)("The URL you provided is not a permalink to a public BuddyPress Activity. Please use another URL.","buddypress"))))})),d=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"bp/embed-activity","title":"Embed an activity","category":"embed","icon":"buddicons-activity","description":"Add a block that displays the activity content pulled from this or other community sites.","keywords":["BuddyPress","activity","community"],"textdomain":"buddypress","attributes":{"url":{"type":"string"},"caption":{"type":"string","source":"html","selector":"figcaption"}},"supports":{"align":true},"editorScript":"file:index.js","style":"file:index.css"}');(0,e.registerBlockType)(d,{icon:{background:"#fff",foreground:"#d84800",src:"buddicons-activity"},edit:l,save:({attributes:e})=>{const r=i.useBlockProps.save({className:"wp-block-embed is-type-bp-activity"}),{url:a,caption:s}=e;return a?(0,t.createElement)("figure",{...r},(0,t.createElement)("div",{className:"wp-block-embed__wrapper"},`\n${a}\n`),!i.RichText.isEmpty(s)&&(0,t.createElement)(i.RichText.Content,{tagName:"figcaption",value:s})):null}})})();